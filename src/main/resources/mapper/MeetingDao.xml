<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.real.logicserver.meeting.repository.MeetingDao">
    <resultMap id="BaseResultMap" type="com.real.logicserver.meeting.model.Meeting">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="me_id" jdbcType="INTEGER" property="meId" />
        <result column="start_time" jdbcType="TIMESTAMP" property="startTime" />
        <result column="end_time" jdbcType="TIMESTAMP" property="endTime" />
        <result column="place" jdbcType="VARCHAR" property="place" />
        <result column="num" jdbcType="INTEGER" property="num" />
        <result column="desc" jdbcType="VARCHAR" property="desc" />
        <result column="title" jdbcType="VARCHAR" property="title" />
        <result column="logo" jdbcType="VARCHAR" property="logo" />
        <result column="type_id" jdbcType="INTEGER" property="typeId" />
        <result column="is_aduit" jdbcType="VARCHAR" property="isAduit" />
    </resultMap>
    <resultMap id="SimpleUserInfo" type="com.real.logicserver.meeting.dto.SimpleUserInfo">
        <id column="user_id" jdbcType="INTEGER" property="userId"/>
        <result column="avatar_url" jdbcType="VARCHAR" property="avatarUrl"/>
        <result column="nike_name" property="nikeName" jdbcType="VARCHAR"/>
    </resultMap>
    <resultMap id="MeetingSimpleInfo" type="com.real.logicserver.meeting.dto.MeetingSimpleInfo">
        <id column="me_id" jdbcType="INTEGER" property="mid"/>
        <result column="title" jdbcType="VARCHAR" property="title"/>
        <result column="desc" jdbcType="VARCHAR" property="desc"/>
        <result column="start_time" jdbcType="TIMESTAMP" property="start"/>
        <result column="end_time" jdbcType="TIMESTAMP" property="end"/>
        <result column="logo" jdbcType="VARCHAR" property="logo"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        me_id, start_time, end_time, place, num, `desc`, title, logo, type_id, is_aduit
    </sql>
    <select id="isExist" parameterType="INTEGER">
        SELECT count(*)
        FROM meeting
        WHERE me_id = #{meid,jdbcType=INTEGER}
        LIMIT 1
    </select>
    <select id="getMembersByMeId" resultMap="SimpleUserInfo" parameterType="Integer">
      SELECT user_detail.avatar_url,user_detail.nick_name,user_detail.user_id
        FROM user_detail,meeting_user
        where meeting_user.me_id = #{mid,jdbcType=INTEGER}
        AND meeting_user.user_id = user_detail.user_id
    </select>
    <select id="getMeetingsByQuery" resultMap="MeetingSimpleInfo">
        SELECT me_id,start_time,end_time,logo,title,`desc`
        FROM meeting ORDER BY num DESC
    </select>
</mapper>